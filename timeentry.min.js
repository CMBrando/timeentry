/* https://github.com/CMBrando/timeentry
   Vanilla JS time entry fork of jquery plugin at: https://github.com/kbwood/timeentry
   Brandon Kuehl October 2021
   Available under the MIT (https://opensource.org/licenses/MIT) license.
*/
var TimeEntry=function(){"use strict";return function(e,t){var n={appendText:"",showSeconds:!1,unlimitedHours:!1,timeSteps:[1,1,1],initialField:null,noSeparatorEntry:!1,tabToExit:!1,useMouseWheel:!0,defaultTime:null,minTime:null,maxTime:null,beforeShow:null,beforeSetTime:null,show24Hours:!1,separator:":",ampmPrefix:"",ampmNames:["AM","PM"]},a="string"==typeof e?document.getElementById(e):e,r=Object.assign({},n,t||{});r.show24Hours=r.show24Hours||r.unlimitedHours;var s=!1,i=0,o=0,u=0,m=0,l=1,c=null,f="",d={},v={setOptions:function(e){(r=Object.assign({},r,e||{})).show24Hours=r.show24Hours||r.unlimitedHours},destroy:function(){a.removeEventListener("focus",p),a.removeEventListener("blur",h),a.removeEventListener("click",g),a.removeEventListener("keydown",S),a.removeEventListener("keypress",b),a.removeEventListener("wheel",y),a.removeEventListener("paste",T),r=n},setTime:function(e){null===e||""===e?a.value="":I(e?Array.isArray(e)?e:"object"==typeof e?new Date(e.getTime()):e:null)},getTime:function(){var e=E();return e?new Date(0,0,0,e[0],e[1],e[2]):null},getOffset:function(){var e=E();return e?1e3*(3600*e[0]+60*e[1]+e[2]):0}},p=function(e){var t=e.nodeName&&"input"===e.nodeName.toLowerCase()?e:this;d===t||t.disabled?s=!1:(s=!0,d=t,r=Object.assign({},r,"function"==typeof r.beforeShow?r.beforeShow.apply(t):{}),H(e.nodeName?null:e),setTimeout(function(){L()},10))},h=function(e){d=null},g=function(e){var t=e.target,n=i;s||(i=w(t,e)),n!==i&&(f=""),L(),s=!1},w=function(e,t){var n,s=0,i=[a.value.split(r.separator)[0].length,2,2];if(null!==e.selectionStart)for(var o=0,u=0;u<=Math.max(1,l,c)&&(o+=u!==c?i[u]+r.separator.length:r.ampmPrefix.length+r.ampmNames[0].length,s=u,!(e.selectionStart<o));u++);else if(e.createTextRange&&null!=t){var m=$(t.srcElement),f=e.createTextRange(),d=t.clientX+document.documentElement.scrollLeft-(m.offset().left+parseInt({thin:2,medium:4,thick:6}[n=m.css("border-left-width")]||n,10))-f.offsetLeft;for(u=0;u<=Math.max(1,l,c)&&(o=u!==c?u*fieldSize+2:c*fieldSize+r.ampmPrefix.length+r.ampmNames[0].length,f.collapse(),f.moveEnd("character",o),s=u,!(d<f.boundingWidth));u++);}return s},T=function(e){setTimeout(function(){H()},1)},S=function(e){if(e.keyCode>=48)return!0;var t=!1;switch(e.keyCode){case 9:t=!!r.tabToExit||(e.shiftKey?A(-1,!0):A(1,!0));break;case 35:e.ctrlKey?N(""):(i=Math.max(1,l,c),C(0));break;case 36:e.ctrlKey?I():(i=0,C(0));break;case 37:A(-1,!1);break;case 38:C(1);break;case 39:A(1,!1);break;case 40:C(-1);break;case 46:N("");break;case 8:f="";default:return!0}return t||e.preventDefault(),t},b=function(e){var t=String.fromCharCode(void 0===e.charCode?e.keyCode:e.charCode);return t<" "||(x(t),e.preventDefault(),!1)},x=function(e){if(e===r.separator)A(1,!1);else if(e>="0"&&e<="9"){var t=parseInt(e,10),n=parseInt(f+e,10),a=0!==i?o:r.unlimitedHours?n:r.show24Hours?n<24?n:t:(n>=1&&n<=12?n:t>0?t:o)%12+(o>=12?12:0),s=M([a,1!==i?u:n<60?n:t,i!==l?m:n<60?n:t]);I(r.unlimitedHours?s:new Date(0,0,0,s[0],s[1],s[2])),r.noSeparatorEntry&&f?A(1,!1):f=r.unlimitedHours&&0===i?f+e:e}else if(!r.show24Hours&&((e=e.toLowerCase())===r.ampmNames[0].substring(0,1).toLowerCase()&&o>=12||e===r.ampmNames[1].substring(0,1).toLowerCase()&&o<12)){var d=i;i=c,C(1),i=d,L()}},y=function(e){var t=Math.sign(e.deltaY);e.target.disabled||(a.focus(),a.value||H(),C(t),e.preventDefault())},H=function(e){var t=E();if(t)o=t[0],u=t[1],m=t[2];else{var n=M();o=n[0],u=n[1],m=r.showSeconds?n[2]:0}l=r.showSeconds?2:-1,c=r.show24Hours?-1:r.showSeconds?3:2,f="";var s=function(){""!==a.value&&k()};"number"==typeof r.initialField?(i=Math.max(0,Math.min(Math.max(1,l,c),r.initialField)),s()):setTimeout(function(){i=w(a,e),s()},0)},E=function(e){var t=(e=e||a.value).split(r.separator);if(""===r.separator&&""!==e&&(t[0]=e.substring(0,2),t[1]=e.substring(2,4),t[2]=e.substring(4,6)),t.length>=2){var n=!r.show24Hours&&e.indexOf(r.ampmNames[0])>-1,s=!r.show24Hours&&e.indexOf(r.ampmNames[1])>-1,i=parseInt(t[0],10);i=isNaN(i)?0:i,i=((n||s)&&12===i?0:i)+(s?12:0);var o=parseInt(t[1],10);o=isNaN(o)?0:o;var u=t.length>=3?parseInt(t[2],10):0;return u=isNaN(u)||!r.showSeconds?0:u,M([i,o,u])}return null},M=function(e){if(null==e){var t=O(r.defaultTime)||new Date;e=[t.getHours(),t.getMinutes(),t.getSeconds()]}for(var n=!1,a=0;a<r.timeSteps.length;a++)n?e[a]=0:r.timeSteps[a]>1&&(e[a]=Math.round(e[a]/r.timeSteps[a])*r.timeSteps[a],n=!0);return e},k=function(){var e=(r.unlimitedHours?o:D(r.show24Hours?o:(o+11)%12+1))+r.separator+D(u)+(r.showSeconds?r.separator+D(m):"")+(r.show24Hours?"":r.ampmPrefix+r.ampmNames[o<12?0:1]);N(e),L()},L=function(){var e=a;if(!a.hidden&&d===e){for(var t=[a.value.split(r.separator)[0].length,2,2],n=0,s=0;s<i;)n+=t[s]+(s===Math.max(1,l)?0:r.separator.length),s++;var o=n+(i!==c?t[s]:r.ampmPrefix.length+r.ampmNames[0].length);if(e.setSelectionRange)e.setSelectionRange(n,o);else if(e.createTextRange){var u=e.createTextRange();u.moveStart("character",n),u.moveEnd("character",o-a.value.length),u.select()}e.disabled||e.focus()}},D=function(e){return(e<10?"0":"")+e},N=function(e){e!==a.value&&(a.value=e,a.dispatchEvent(new Event("change")))},A=function(e,t){var n=""===a.value||i===(-1===e?0:Math.max(1,l,c));return n||(i+=e),L(),f="",n&&t},C=function(e){""===a.value&&(e=0),r.unlimitedHours?I([o+(0===i?e*r.timeSteps[0]:0),u+(1===i?e*r.timeSteps[1]:0),m+(i===l?e*r.timeSteps[2]:0)]):I(new Date(0,0,0,o+(0===i?e*r.timeSteps[0]:0)+(i===c?12*e:0),u+(1===i?e*r.timeSteps[1]:0),m+(i===l?e*r.timeSteps[2]:0)))},I=function(e){if(r.unlimitedHours&&Array.isArray(e))var t=e;else t=(e=O(e))?[e.getHours(),e.getMinutes(),e.getSeconds()]:null;t=M(t),e=new Date(0,0,0,t[0],t[1],t[2]),e=P(e);var n=P(O(r.minTime)),s=P(O(r.maxTime));if(r.unlimitedHours){for(;t[2]<0;)t[2]+=60,t[1]--;for(;t[2]>59;)t[2]-=60,t[1]++;for(;t[1]<0;)t[1]+=60,t[0]--;for(;t[1]>59;)t[1]-=60,t[0]++;n=null!=r.minTime&&Array.isArray(r.minTime)?r.minTime:[0,0,0],t[0]<n[0]?t=n.slice(0,3):t[0]===n[0]&&(t[1]<n[1]?(t[1]=n[1],t[2]=n[2]):t[1]===n[1]&&t[2]<n[2]&&(t[2]=n[2])),null!=r.maxTime&&Array.isArray(r.maxTime)&&(t[0]>r.maxTime[0]?t=r.maxTime.slice(0,3):t[0]===r.maxTime[0]&&(t[1]>r.maxTime[1]?(t[1]=r.maxTime[1],t[2]=r.maxTime[2]):t[1]===r.maxTime[1]&&t[2]>r.maxTime[2]&&(t[2]=r.maxTime[2])))}else n&&s&&n>s?e<n&&e>s&&(e=Math.abs(e-n)<Math.abs(e-s)?n:s):e=n&&e<n?n:s&&e>s?s:e,t[0]=e.getHours(),t[1]=e.getMinutes(),t[2]=e.getSeconds();"function"==typeof r.beforeSetTime&&(e=r.beforeSetTime.apply(a,[v.getTime(a),e,n,s]),t[0]=e.getHours(),t[1]=e.getMinutes(),t[2]=e.getSeconds()),o=t[0],u=t[1],m=t[2],k()},O=function(e){var t,n;return e?"string"==typeof e?function(e){var t=E(e),n=new Date,a=t?t[0]:n.getHours(),r=t?t[1]:n.getMinutes(),s=t?t[2]:n.getSeconds();if(!t)for(var i=/([+-]?[0-9]+)\s*(s|S|m|M|h|H)?/g,o=i.exec(e);o;){switch(o[2]||"s"){case"s":case"S":s+=parseInt(o[1],10);break;case"m":case"M":r+=parseInt(o[1],10);break;case"h":case"H":a+=parseInt(o[1],10)}o=i.exec(e)}return n=new Date(0,0,10,a,r,s,0),/^!/.test(e)&&(n.getDate()>10?n=new Date(0,0,10,23,59,59):n.getDate()<10&&(n=new Date(0,0,10,0,0,0))),n}(e):"number"==typeof e?(t=e,(n=new Date).setTime(n.getTime()+1e3*t),n):Array.isArray(e)?function(e){return new Date(0,0,0,e[0],e[1]||0,e[2]||0,0)}(e):e:null},P=function(e){return e?(e.setFullYear(1900),e.setMonth(0),e.setDate(0),e):null};return a.addEventListener("focus",p),a.addEventListener("blur",h),a.addEventListener("click",g),a.addEventListener("keydown",S),a.addEventListener("keypress",b),r.useMouseWheel&&a.addEventListener("wheel",y),""==a.value&&r.defaultTime&&I(),a.addEventListener("paste",T),v}}();